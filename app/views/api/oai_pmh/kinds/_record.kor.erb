<% cache record do %>
<kor:kind
  xmlns:kor="https://coneda.net/XMLSchema/1.0/"
  xsi:schemaLocation="https://coneda.net/XMLSchema/1.0/ 
                      https://coneda.net/XMLSchema/1.0/kor.xsd"
>
  <kor:id><%= record.uuid %></kor:id>
  <kor:created-at><%= timestamp record.created_at %></kor:created-at>
  <kor:updated-at><%= timestamp record.updated_at %></kor:updated-at>
  <kor:name><%= record.name %></kor:name>
  <kor:plural-name><%= record.plural_name %></kor:plural-name>
  <kor:description><%= record.description %></kor:description>
  <kor:settings><%= record.settings.to_json %></kor:settings>
  <kor:fields>
    <% record.fields.each do |field| %>
      <kor:field>
        <kor:id><%= field.uuid %></kor:id>
        <kor:created-at><%= timestamp field.created_at %></kor:created-at>
        <kor:updated-at><%= timestamp field.updated_at %></kor:updated-at>
        <kor:local-id><%= field.id %></kor:local-id>
        <kor:type><%= field.type %></kor:type>
        <kor:name><%= field.name %></kor:name>
        <kor:label><%= field.show_label %></kor:label>
        <kor:form-label><%= field.form_label %></kor:form-label>
        <kor:search-label><%= field.search_label %></kor:search-label>
        <kor:settings><%= field.settings.to_json %></kor:settings>
      </kor:field>
    <% end %>
  </kor:fields>
  <kor:generators>
    <% record.generators.each do |generator| %>
      <kor:generator>
        <kor:id><%= generator.id %></kor:id>
        <kor:name><%= generator.name %></kor:name>
        <kor:directive><%= generator.directive %></kor:directive>
        <kor:created-at><%= timestamp generator.created_at %></kor:created-at>
        <kor:updated-at><%= timestamp generator.updated_at %></kor:updated-at>
      </kor:generator>
    <% end %>
  </kor:generators>
  <kor:parents>
    <% record.parents.each do |parent| %>
      <kor:ref type="kind" id="<%= parent.uuid %>"></kor:ref>
    <% end %>
  </kor:parents>
  <kor:children>
    <% record.children.each do |child| %>
      <kor:ref type="kind" id="<%= child.uuid %>"></kor:ref>
    <% end %>
  </kor:children>
</kor:kind>
<% end %>